---
name: steering
description: 機能追加時の作業管理スキル。要件定義・タスク管理・振り返りを統一フォーマットで実施。
---

# Steering スキル

機能追加や大きな変更を行う際、このスキルに従って作業を進めてください。

## いつ使うか

- 新機能の追加
- 複数ファイルにまたがる変更
- 1時間以上かかりそうな作業

**使わなくていい場合**: バグ修正、ドキュメント更新、単一ファイルの小さな変更

## ディレクトリ構造

```
.steering/
└── YYYYMMDD-機能名/
    ├── requirements.md    # 要件定義（必須）
    ├── design.md          # 設計書（必須）
    └── tasklist.md        # タスクリスト（必須）
```

例: `.steering/20250102-book-crud/`

---

## 3つのモード

### 1. 計画モード

**目的**: 作業を始める前に要件とタスクを明確にする

**手順**:
1. `.steering/YYYYMMDD-機能名/` ディレクトリを作成
2. `requirements.md` を作成（ユーザーと要件を確認）
3. `design.md` を作成（設計判断を記録）
4. `tasklist.md` を作成（具体的なタスクに分解）

**design.md テンプレート**:
```markdown
# 設計書

## 意思決定

### 採用した設計
{採用した設計方針を簡潔に記述}

### 代替案との比較
| 案 | メリット | デメリット | 採用 |
|----|---------|-----------|------|
| 案A | - | - | ✓ |
| 案B | - | - | - |

### 選定理由
{なぜこの設計を選んだか}

## データフロー

### {ユースケース名}
1. {ステップ1}
2. {ステップ2}
3. {ステップ3}

## コンポーネント設計

### 追加・変更するファイル

| ファイル | 種別 | 責務 |
|---------|------|------|
| `path/to/file.ts` | 新規 | {責務} |
| `path/to/existing.ts` | 変更 | {変更内容} |

### 主要コンポーネント

#### {コンポーネント名}
**責務**: {責務}

**インターフェース**:
```typescript
// 主要な型・関数シグネチャ
```

## テスト戦略

### ユニットテスト
- {テスト対象1}: {何をテストするか}
- {テスト対象2}: {何をテストするか}

### 統合テスト（必要な場合）
- {シナリオ}

---

## 任意セクション（該当する場合のみ）

### エラーハンドリング
{複雑なエラー処理がある場合}

### 依存ライブラリ
{新しく追加するライブラリがある場合}

### セキュリティ考慮事項
{認証・認可・入力検証等}

### パフォーマンス考慮事項
{最適化が必要な場合}
```

**requirements.md テンプレート**:
```markdown
# 機能名

## 概要
1-2文で機能の目的を説明

## 要件
- [ ] 要件1
- [ ] 要件2
- [ ] 要件3

## 非機能要件（あれば）
- パフォーマンス、セキュリティ等

## 対象外（スコープ外）
- この作業では対応しないこと
```

**tasklist.md テンプレート**:
```markdown
# タスクリスト

## 進捗
- 開始: YYYY-MM-DD
- 完了: （未完了）

## タスク

### フェーズ1: 基盤
- [ ] タスク1
- [ ] タスク2

### フェーズ2: 実装
- [ ] タスク3
- [ ] タスク4

### フェーズ3: テスト・仕上げ
- [ ] タスク5
- [ ] タスク6
```

---

### 2. 実装モード

**目的**: tasklist.md に従って実装を進める

**ルール**:
1. **tasklist.md が正式なドキュメント**
   - TodoWrite ツールは補助的に使用
   - ユーザーが見るのは tasklist.md
2. **タスク完了時は即座に更新**
   - `- [ ]` → `- [x]` に変更
   - 次のタスクに着手する前に必ず更新
3. **スキップは理由を明記**
   - 技術的な理由でスキップする場合のみ許可
   - `- [~] タスク名 (スキップ理由: xxx)` の形式
4. **追加タスクは末尾に追記**
   - 実装中に発見したタスクは tasklist.md に追加

**進捗更新の例**:
```markdown
### フェーズ1: 基盤
- [x] データベーススキーマ定義
- [x] リポジトリ層の実装
- [ ] サービス層の実装  ← 現在ここ
```

---

### 3. 振り返りモード

**目的**: 作業完了後に学びを記録

**手順**:
1. tasklist.md の「完了」日付を記入
2. 以下を tasklist.md 末尾に追記:

```markdown
## 振り返り

### うまくいったこと
-

### 改善点
-

### 次回への学び
-
```

3. 重要な決定事項は `docs/CONTEXT.md` にも転記

---

## 重要なルール

### やるべきこと
- [ ] 作業開始前に requirements.md を作成し、ユーザーの承認を得る
- [ ] tasklist.md は常に最新の状態を維持
- [ ] 1タスク完了ごとに tasklist.md を更新
- [ ] 作業完了後は振り返りを記録

### やってはいけないこと
- [ ] 未完了タスクを残したまま作業を終了
- [ ] tasklist.md の更新を後回しにする
- [ ] 要件を確認せずに実装を始める

---

## ワークフロー図

```
[ユーザーからの依頼]
        ↓
[計画モード] requirements.md 作成
        ↓
[ユーザー承認] ← 要件に問題あれば修正
        ↓
[計画モード] design.md 作成
        ↓
[ユーザー承認] ← 設計に問題あれば修正
        ↓
[計画モード] tasklist.md 作成
        ↓
[実装モード] タスクを1つずつ実行
        ↓ （各タスク完了時に tasklist.md 更新）
[全タスク完了]
        ↓
[振り返りモード] 学びを記録
        ↓
[完了]
```
